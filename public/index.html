<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Vision Condition Visualizer - A tool for understanding different vision conditions"
    />
    <!-- Content Security Policy -->
    <!-- Note: CSP is set permissively for development. For production, consider using a more restrictive policy via server headers. -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* https://localhost:* https://fast.wistia.com https://fast.wistia.net http://fast.wistia.net blob:; script-src-elem 'self' 'unsafe-inline' http://localhost:* https://localhost:* https://fast.wistia.com https://fast.wistia.net http://fast.wistia.net blob:; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: http://localhost:* https://localhost:* https://fast.wistia.com https://fast.wistia.net http://fast.wistia.net; connect-src 'self' http://localhost:* https://localhost:* https://fast.wistia.com https://fast.wistia.net http://fast.wistia.net https://www.youtube.com https://youtube.com ws://localhost:* wss://localhost:*; font-src 'self' data:; object-src 'none'; base-uri 'self'; form-action 'self'; worker-src 'self' blob:; child-src 'self' blob:; frame-src 'self' https://fast.wistia.com https://fast.wistia.net http://fast.wistia.net https://www.youtube.com https://youtube.com;">
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Vision Condition Visualizer</title>
    <!-- Wistia Player Scripts -->
    <script>
      // Load Wistia scripts with error handling
      function loadWistiaScript(src, type) {
        return new Promise((resolve, reject) => {
          const script = document.createElement('script');
          script.src = src;
          script.async = true;
          if (type) script.type = type;
          script.onload = resolve;
          script.onerror = () => {
            console.warn('Failed to load Wistia script:', src);
            resolve(); // Resolve anyway to not block the app
          };
          document.head.appendChild(script);
        });
      }
      
      // Load Wistia scripts
      Promise.all([
        loadWistiaScript('https://fast.wistia.com/player.js'),
        loadWistiaScript('https://fast.wistia.com/embed/qjdv24o4kb.js', 'module')
      ]).catch(err => {
        console.warn('Some Wistia scripts failed to load:', err);
      });
    </script>
    <style>
      wistia-player[media-id='qjdv24o4kb']:not(:defined) { 
        background: center / contain no-repeat url('https://fast.wistia.com/embed/medias/qjdv24o4kb/swatch'); 
        display: block; 
        filter: blur(5px); 
        padding-top:37.92%; 
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    
    <!-- SVG Filter Definitions for Color Blindness Simulation -->
    <svg style="display: none;">
      <defs>
        <!-- Protanopia (Red-Blind) -->
        <filter id="protanopia">
          <feColorMatrix type="matrix" values="
            0.567, 0.433, 0,     0, 0
            0.558, 0.442, 0,     0, 0
            0,     0.242, 0.758, 0, 0
            0,     0,     0,     1, 0"/>
        </filter>
        
        <!-- Deuteranopia (Green-Blind) -->
        <filter id="deuteranopia">
          <feColorMatrix type="matrix" values="
            0.625, 0.375, 0,   0, 0
            0.7,   0.3,   0,   0, 0
            0,     0.3,   0.7, 0, 0
            0,     0,     0,   1, 0"/>
        </filter>
        
        <!-- Tritanopia (Blue-Blind) -->
        <filter id="tritanopia">
          <feColorMatrix type="matrix" values="
            0.95, 0.05,  0,     0, 0
            0,    0.433, 0.567, 0, 0
            0,    0.475, 0.525, 0, 0
            0,    0,     0,     1, 0"/>
        </filter>
        
        <!-- Protanomaly (Red-Weak) -->
        <filter id="protanomaly">
          <feColorMatrix type="matrix" values="
            0.817, 0.183, 0,     0, 0
            0.333, 0.667, 0,     0, 0
            0,     0.125, 0.875, 0, 0
            0,     0,     0,     1, 0"/>
        </filter>
        
        <!-- Deuteranomaly (Green-Weak) -->
        <filter id="deuteranomaly">
          <feColorMatrix type="matrix" values="
            0.8,   0.2,   0,     0, 0
            0.258, 0.742, 0,     0, 0
            0,     0.142, 0.858, 0, 0
            0,     0,     0,     1, 0"/>
        </filter>
        
        <!-- Tritanomaly (Blue-Weak) -->
        <filter id="tritanomaly">
          <feColorMatrix type="matrix" values="
            0.967, 0.033, 0,     0, 0
            0,     0.733, 0.267, 0, 0
            0,     0.183, 0.817, 0, 0
            0,     0,     0,     1, 0"/>
        </filter>
        
        <!-- Monochromacy (Complete Color Blindness) -->
        <filter id="monochromacy">
          <feColorMatrix type="matrix" values="
            0.299, 0.587, 0.114, 0, 0
            0.299, 0.587, 0.114, 0, 0
            0.299, 0.587, 0.114, 0, 0
            0,     0,     0,     1, 0"/>
        </filter>
        
        <!-- Blue Cone Monochromacy -->
        <filter id="bluecone-monochromacy">
          <feColorMatrix type="matrix" values="
            0.01,  0.99,  0,     0, 0
            0.01,  0.99,  0,     0, 0
            0.01,  0.99,  0,     0, 0
            0,     0,     0,     1, 0"/>
        </filter>
      </defs>
    </svg>
    
    <div id="root"></div>
    
    <!-- Start Single Page Apps for GitHub Pages -->
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      // This script checks to see if a redirect is present in the query string,
      // converts it back into the correct url and adds it to the
      // browser's history using window.history.replaceState(...),
      // which won't cause the browser to attempt to load the new url.
      // When the single page app is loaded further down in this file,
      // the correct url will be waiting in the browser's history for
      // the single page app to route accordingly.
      (function(l) {
        if (l.search[1] === '/' ) {
          var decoded = l.search.slice(1).split('&').map(function(s) { 
            return s.replace(/~and~/g, '&')
          }).join('?');
          window.history.replaceState(null, null,
              l.pathname.slice(0, -1) + decoded + l.hash
          );
        }
      }(window.location))
    </script>
    <!-- End Single Page Apps for GitHub Pages -->
  </body>
</html> 